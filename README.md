# Анализ временных рядов солнечных радиоданных NoRH нелинейным методом Грассбергера-Прокаччиа

Целью данной работы является изучение поведения нелинейной системы с помощью метода Грассбергера-Прокаччиа. Сначала исследуются временные ряды, полученные из решения системы, описывающей аттрактор Лоренца, чтобы проверить правильность реализации данного метода и отработать его на системе с известным конечным результатом. После этого метод Грассбергера-Прокаччиа применяется к реальным радиоданным от солнечных вспышек, зарегистрированных инструментом [NoRH (Nobeyama RadioHeliograph)](https://solar.nro.nao.ac.jp/norh/). 


## Метод Грассбергера-Прокаччиа

Алгоритм Грассбергера-Прокаччиа является простым и эффективным для оценки корреляционной размерности в нелинейной динамике. Если рассмотреть покрытие аттрактора ячейками радиусом $r$, и предположить, что выбраны наугад две точки, принадлежащие аттрактору $X_1$  и $X_2$, то вероятность того, что одна из них окажется в $i$-той ячейке, равна $p_i$, а вероятность того, что обе точки окажутся в этой ячейке, равна $p_i^2$ (попадание обеих точек в данную ячейку можно считать независимыми событиями). 

Рассматривая сумму $C(r) = \sum_{i=1}^{N} p_i^2$, замечаем, что при уменьшении $r$, сумма будет убывать по степенному закону $C(r) \simeq r^{D_2}$, что эквивалентно тому, что существует предел

$$ D_2 = \lim_{r \rightarrow 0} \frac{C(r)}{\log(r)} $$

Величина $D_2$ называется __корреляционной размерностью__. Корреляционная размерность способна дать информацию о нелинейной системе до построения фазового портрета, о ее динамике и структуре. Чем больше $D_2$, тем больше хаоса в системе, что свидетельствует о сложной струкутре сигнала, например, о наличиии нескольких аттракторов.

Алгоритм состоит в следующем. Пусть у нас есть численное решение уравнений динамики. И из него мы получили набор векторов состояния ${X_i,i=1, 2, ..., N}$. Задавшись некоторым $r$, мы можем использовать наш набор данных для оценки суммы $C(r)$ – вероятности того, что две точки разделены расстоянием, меньше r. Имеем:
 
$$
C(r)=\sum_{i=1}^N p_i^2=\lim_{N \rightarrow \infty} \frac{1}{N(N-1)} \cdot \sum_{i, j=1}^N \theta\left(r-\left\|X_i-X_j\right\|\right) \equiv C_M(r)
$$

где $\theta(x)$ - функция Хевисайда. Величину $C_M (r)$  называют __корреляционным интегралом__. Другими словами, мы ищем число пар $i \neq j$, таких что $|X_i-X_j|<r$. При достаточно больших $N$, корреляционный интеграл служит статистической оценкой суммы $C(r)$, и потому может быть использован для вычисления корреляционной размерности.

Предполагая, что $C_M(r) \simeq r^{D_2}$, и рассчитав $C_M(r)$ для различных $r$, мы можем построить результаты в логарифмической шкале, $\log ⁡C(r)$  от  $\log ⁡r$. В таком случае, полученный график должен иметь вид прямой линии с угловым коэффициентом, равным $D_2$.

## Аттрактор Лоренца

$$
\left\{\begin{array}{c}
\dot{x}=\sigma(y-x) \\
\dot{y}=x(r-z)-y \\
\dot{z}=x y-b z
\end{array}\right.
$$

В нашей задаче мы ищем оценку $D_2$ на основе одного временного ряда. Понадобится реконструкция фазового пространства обычным методом временной задержки. Параметр $m$ будет являться размерностью встраивания (__embedding dimension__), его правильный выбор обеспечит более удачный результат и позволит сделать более точные выводы о степени хаоса системы.



